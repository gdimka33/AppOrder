import tkinter as tk
from tkinter import ttk
from logger import logger

class СписокСотрудников(ttk.Frame):
    """
    Класс для отображения списка сотрудников в центральном фрейме.
    Принимает параметр тип_сотрудника для фильтрации списка.
    """
    def __init__(self, родитель, тип_сотрудника, главное_окно=None):
        super().__init__(родитель)
        self.тип_сотрудника = тип_сотрудника
        self.главное_окно = главное_окно
        
        # Растягиваем фрейм на всю ширину и высоту родительского контейнера
        self.pack(fill='both', expand=True)
        
        # Устанавливаем заголовок главного окна
        if self.главное_окно:
            заголовок = f"Учет личного состава - Список {self._получить_название_типа()}"
            self.главное_окно.title(заголовок)
        
        # Создаем левый и правый фреймы
        self._создать_фреймы()
        
        logger.info(f"Открыт список сотрудников: {self.тип_сотрудника}")
    
    def _получить_название_типа(self):
        """Возвращает название типа сотрудника в нужном падеже"""
        if self.тип_сотрудника == "офицер":
            return "офицеров"
        elif self.тип_сотрудника == "курсант":
            return "курсантов"
        else:
            return "сотрудников"
    
    def _получить_название_типа_ед(self):
        """Возвращает название типа сотрудника в единственном числе"""
        if self.тип_сотрудника == "офицер":
            return "офицера"
        elif self.тип_сотрудника == "курсант":
            return "курсанта"
        else:
            return "сотрудника"
    
    def _создать_фреймы(self):
        """Создает левый и правый фреймы"""
        # Создаем левый фрейм для таблицы
        self.Таблица_сотрудников = ttk.Frame(self)
        self.Таблица_сотрудников.pack(side='left', fill='both', expand=True)
        
        # Создаем правый фрейм для меню, прилипающий к правому краю
        self.Меню_списка_сотрудников = ttk.Frame(self, width=200)
        self.Меню_списка_сотрудников.pack(side='right', fill='y')
        # Фиксируем ширину правого фрейма
        self.Меню_списка_сотрудников.pack_propagate(False)
        
        # Создаем группу "Добавить" для кнопок
        группа_добавить = ttk.LabelFrame(self.Меню_списка_сотрудников, text="Добавить", padding=10)
        группа_добавить.pack(fill='x', pady=5, padx=5)
        
        # Добавляем кнопки в группу с учетом типа сотрудника
        текст_кнопки = f"Добавить {self._получить_название_типа_ед()}"
        ttk.Button(группа_добавить, text=текст_кнопки).pack(fill='x', pady=2)
        ttk.Button(группа_добавить, text="Добавить из файла").pack(fill='x', pady=2)
    
